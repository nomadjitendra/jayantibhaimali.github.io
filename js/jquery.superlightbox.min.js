jQuery.fn.superLightBox = function(e) {
    var n, l, o, i, u = [],
        s = [],
        a = [],
        p = [],
        h = [],
        r = 0,
        q = 0,
        L = 0,
        g = jQuery.extend({}, {
            gallery: !0,
            swipe: !0,
            keyboard: !0,
            closeOutClick: !0,
            videopreviewurl: "images/video-preview.jpg",
            galleryThumbnailWidth: 100,
            galleryThumbanilGap: 1,
            maxZoom: 3,
            mediaAttribute: "href",
            mediaCaption: "data-superlightcaption"
        }, e);
    g.keyboard && jQuery(document).keyup(function(e) {
        jQuery(".superlightboxcontainer").length && jQuery(".superlightboxcontainer").hasClass(i) && (e.preventDefault(), 27 == e.keyCode ? b() : 37 == e.keyCode || 38 == e.keyCode ? x(n - 1) : 39 != e.keyCode && 40 != e.keyCode || x(n + 1))
    }), jQuery(window).resize(function() {
        jQuery(".superlightboxcontainer").length && jQuery(".superlightboxcontainer").hasClass(i) && (w(), c())
    });

    function t(e) {
        if (jQuery(".superlightboxcontainer").length) {
            var i = jQuery(window).width();
            if (jQuery(".superlightbox_gallery_wrapper").width() > i) {
                var r = parseInt(jQuery(".superlightbox_gallery_wrapper").position().left) - e * i,
                    t = -jQuery(".superlightbox_gallery_wrapper").width() + i;
                r < t ? r = t : 0 < r && (r = 0), jQuery(".superlightbox_gallery_wrapper").animate({
                    left: r
                }, g.easingTime, function() {})
            }
        }
    }
    var d = function() {
            var e = "";
            for (var i in u) e += y(u[i], i);
            jQuery(".superlightbox_gallery_wrapper").append(e);
            var r = 0;
            jQuery(".superlightbox_gallery_wrapper > div").each(function(e) {
                var i = e * g.galleryThumbnailWidth + e * g.galleryThumbanilGap;
                r = i, jQuery(this).css({
                    left: i
                })
            }), r += g.galleryThumbnailWidth, jQuery(".superlightbox_gallery_wrapper").width(r)
        },
        c = function() {
            if (jQuery(".superlightboxcontainer").length && g.gallery) {
                if (jQuery(window).width() > jQuery(".superlightbox_gallery_wrapper").width()) {
                    var e = (jQuery(window).width() - jQuery(".superlightbox_gallery_wrapper").width()) / 2;
                    jQuery(".superlightbox_gallery_wrapper").css({
                        left: e
                    })
                } else jQuery(".superlightbox_gallery_wrapper").css({
                    left: 0
                });
                jQuery(".superlightbox_gallery_wrapper").is(":visible") ? jQuery(".superlightbox_gallery_nav").show() : jQuery(".superlightbox_gallery_nav").hide()
            }
        },
        y = function(e, i) {
            if (jQuery.isFunction(e)) return "";
            var r = Y(e),
                t = "",
                s = "";
            return "image" == r ? t = e : "youtube" == r ? (t = M(e), s = " superlightbox_video" + I(e)) : "vimeo" == r && (t = g.videopreviewurl, W(e), s = " superlightbox_video" + S(e)), '<div class="superlightbox_thumb' + i + s + '" style="background-image: url(\'' + t + "')\"></div>"
        },
        b = function() {
            if (jQuery(".superlightboxcontainer").length) {
                var e = jQuery(".superlightbox_slide" + n);
                e.length && e.addClass("superlightbox_remove"), jQuery(".superlightboxcontainer").fadeOut("slow", function() {
                    jQuery(this).remove()
                })
            }
        },
        _ = function() {
            jQuery(".superlightboxcontainer").length && (jQuery(".superlightbox_close").click(function() {
                b()
            }), g.closeOutClick && jQuery(".superlightbox_slider").click(function(e) {
                "IMG" != e.target.nodeName && b()
            }), jQuery(".superlightbox_prev").click(function() {
                x(n - 1)
            }), jQuery(".superlightbox_next").click(function() {
                x(n + 1)
            }), g.gallery && (jQuery(".superlightbox_gallery_button").click(function() {
                jQuery(this).hasClass("superlightbox_gallery_open") ? (jQuery(this).removeClass("superlightbox_gallery_open"), jQuery(this).addClass("superlightbox_gallery_close"), jQuery(".superlightbox_gallery_wrapper").slideDown(), jQuery(".superlightbox_slider").addClass("superlightbox_gallery_visible"), c()) : (jQuery(this).removeClass("superlightbox_gallery_close"), jQuery(this).addClass("superlightbox_gallery_open"), jQuery(".superlightbox_gallery_wrapper").slideUp(), jQuery(".superlightbox_gallery_nav").hide(), jQuery(".superlightbox_slider").removeClass("superlightbox_gallery_visible"))
            }), jQuery(".superlightbox_gallery_prev").click(function() {
                t(-1)
            }), jQuery(".superlightbox_gallery_next").click(function() {
                t(1)
            }), jQuery(".superlightbox_gallery_wrapper > div").click(function() {
                x(jQuery(this).index())
            }), g.swipe && O(".superlightbox_gallery_wrapper", {
                swipeStart: function(e) {
                    r = jQuery(".superlightbox_gallery_wrapper").position().left
                },
                swipe: function(e) {
                    jQuery(window).width();
                    jQuery(".superlightbox_gallery_wrapper").css({
                        left: e.eX - e.sX + r
                    })
                },
                swipeEnd: function(e, i) {
                    Math.abs(e.sX), Math.abs(e.eX);
                    var r = jQuery(window).width(),
                        t = jQuery(".superlightbox_gallery_wrapper").width();
                    if (t < r) {
                        var s = (r - t) / 2;
                        jQuery(".superlightbox_gallery_wrapper").animate({
                            left: s
                        }, g.easingTime)
                    } else 0 < jQuery(".superlightbox_gallery_wrapper").position().left ? jQuery(".superlightbox_gallery_wrapper").animate({
                        left: 0
                    }, g.easingTime) : jQuery(".superlightbox_gallery_wrapper").position().left < -t + r && jQuery(".superlightbox_gallery_wrapper").animate({
                        left: -t + r
                    }, g.easingTime)
                }
            })), g.swipe && O(".superlightbox_wrapper", {
                pinchImage: ".superlightbox_slider > div:eq(1) img",
                maxZoom: g.maxZoom,
                pinchZoom: function(e) {
                    jQuery(".superlightbox_slider > div:eq(1) img").css(e)
                },
                pinchZoomStart: function(e) {
                    jQuery(".superlightbox_slider").addClass("superlightbox_sliding")
                },
                pinchZoomEnd: function(e) {
                    jQuery(".superlightbox_slider").removeClass("superlightbox_sliding"), Q()
                },
                swipeStart: function(e) {
                    jQuery(".superlightbox_slider").addClass("superlightbox_sliding")
                },
                swipe: function(e) {
                    var i = jQuery(window).width();
                    jQuery(".superlightbox_slider").css({
                        left: -i + e.eX - e.sX
                    })
                },
                swipeEnd: function(e, i) {
                    var r = Math.abs(e.sX) - Math.abs(e.eX),
                        t = .2 * (s = jQuery(window).width());
                    if (Math.abs(r) > t) x(0 < r ? n + 1 : n - 1);
                    else {
                        var s = jQuery(window).width();
                        jQuery(".superlightbox_slider").animate({
                            left: -s
                        }, g.easingTime, function() {
                            jQuery(".superlightbox_slider").removeClass("superlightbox_sliding")
                        })
                    }
                }
            }))
        },
        x = function(e) {
            var i = "right";
            e < n && (i = "left"), o = e < 0 || e == u.length - 1 ? (e = u.length - 1, l = e - 1, 0) : e >= u.length || 0 == e ? (e = 0, l = u.length - 1, 1) : (l = e - 1, e + 1);
            var r, t = m(e),
                s = 1;
            e != n ? ("left" == i ? (r = jQuery(".superlightbox_slider > div:first"), s = -1) : r = jQuery(".superlightbox_slider > div:last"), r.hasClass("superlightbox_slide" + e) || (r.replaceWith(t), C(e), Q()), v(s), n = e) : 0 == jQuery(".superlightbox_slider > div.superlightbox_slide" + e).length && (jQuery(".superlightbox_slider > div:first").replaceWith(m(l)), jQuery(".superlightbox_slider > div:eq(1)").replaceWith(t), jQuery(".superlightbox_slider > div:last").replaceWith(m(o)), C(l), C(e), C(o), Q())
        },
        v = function(e) {
            if (jQuery(".superlightboxcontainer").length && 3 == jQuery(".superlightbox_slider > div").length) {
                var i = jQuery(window).width(),
                    r = 0;
                0 < e && (r = -2 * i), jQuery(".superlightbox_slider").addClass("superlightbox_sliding"), jQuery(".superlightbox_slider").animate({
                    left: r
                }, g.easingTime, f)
            }
        },
        f = function() {
            var e = ".superlightbox_slider > .superlightbox_slide" + n,
                i = ".superlightbox_slider > .superlightbox_slide" + o,
                r = ".superlightbox_slider > .superlightbox_slide" + l;
            jQuery(".superlightbox_slider > div").not(e + "," + i + "," + r).remove(), 1 < jQuery(e).length && (0 == jQuery(".superlightbox_slider").position().left ? jQuery(e + ":last").remove() : jQuery(e + ":first").remove()), 1 < jQuery(r).length && jQuery(r + ":last").remove(), 1 < jQuery(i).length && jQuery(i + ":first").remove(), jQuery(".superlightbox_slider > div:first").hasClass("superlightbox_slide" + l) || (jQuery(r).remove(), jQuery(".superlightbox_slider").prepend(m(l)), C(l)), jQuery(".superlightbox_slider > div:last").hasClass("superlightbox_slide" + o) || (jQuery(i).remove(), jQuery(".superlightbox_slider").append(m(o)), C(o)), jQuery(".superlightbox_slider").removeClass("superlightbox_sliding"), Q(), j(n)
        },
        w = function() {
            j(l), j(n), j(o), Q()
        },
        j = function(e) {
            if (jQuery(".superlightboxcontainer").length) {
                var i = jQuery(window).height(),
                    r = jQuery(window).width();
                if (a[e]) {
                    e == n && (q = L = 0);
                    var t = jQuery(".superlightbox_slide" + e),
                        s = a[e],
                        l = p[e],
                        o = parseInt(s * r),
                        u = parseInt(l * i);
                    i < o ? (t.find("img").css({
                        left: "50%",
                        top: "50%"
                    }), h[e].height > i && t.find("img").css({
                        height: i,
                        width: u
                    }), jQuery(".superlightbox_slide" + e).find(".superlightbox_caption").length && jQuery(".superlightbox_slide" + e).find(".superlightbox_caption").css({
                        "max-width": u
                    })) : (t.find("img").css({
                        left: "50%",
                        top: "50%"
                    }), h[e].width > r && t.find("img").css({
                        width: r,
                        height: o
                    }), jQuery(".superlightbox_slide" + e).find(".superlightbox_caption").length && jQuery(".superlightbox_slide" + e).find(".superlightbox_caption").css({
                        "max-width": r
                    }))
                } else jQuery(".superlightbox_slide" + e).find(".superlightbox_embed_wrapper").length && (jQuery(".superlightbox_slide" + e).find(".superlightbox_embed_wrapper").css({
                    "max-width": parseInt(1.77 * i)
                }), jQuery(".superlightbox_slide" + e).find(".superlightbox_caption").length && jQuery(".superlightbox_slide" + e).find(".superlightbox_caption").css({
                    "max-width": parseInt(1.77 * i)
                }))
            }
        },
        Q = function() {
            var i = jQuery(window).width();
            jQuery(".superlightbox_slider > div").each(function(e) {
                jQuery(this).css({
                    left: e * i,
                    width: i
                })
            }), jQuery(".superlightbox_slider").css({
                left: -i,
                width: 3 * i
            })
        },
        m = function(e) {
            if (!u[e]) return "";
            var i, r = u[e],
                t = Y(r);
            return "image" == t ? i = '<div class="superlightbox_slide superlightbox_slide' + e + ' superloading">' : "youtube" == t ? (i = '<div class="superlightbox_slide superlightbox_slide_video superlightbox_slide' + e + '">', i += Z(r)) : "vimeo" == t && (i = '<div class="superlightbox_slide superlightbox_slide_video superlightbox_slide' + e + '">', i += T(r)), "" != s[e] && (i += '<div class="superlightbox_caption">' + s[e] + "</div>"), i += "</div>"
        },
        C = function(e) {
            var i = u[e];
            if ("image" == Y(i)) {
                var r = new Image;
                r.superindex = e, r.onload = X, r.src = i
            } else j(e)
        },
        X = function() {
            if (void 0 !== this.superindex && jQuery(".superlightbox_slide" + this.superindex).length) {
                var e = jQuery(".superlightbox_slide" + this.superindex),
                    i = "";
                "" != s[this.superindex] && (i = '<div class="superlightbox_caption">' + s[this.superindex] + "</div>"), e.html('<img src="' + this.src + '" />' + i), a[this.superindex] = this.naturalHeight / this.naturalWidth, p[this.superindex] = this.naturalWidth / this.naturalHeight, h[this.superindex] = {
                    width: this.naturalWidth,
                    height: this.naturalHeight
                }, j(this.superindex), setTimeout(function() {
                    e.removeClass("superloading")
                }, 800)
            }
        },
        Y = function(e) {
            if (jQuery.isFunction(e)) return "";
            var i = e.split("/").pop().split("#").shift().split("?").shift().split(".").reverse()[0].toLowerCase();
            return -1 < jQuery.inArray(i, ["jpg", "jpeg", "png", "gif"]) ? "image" : E(e) ? "youtube" : k(e) ? "vimeo" : ""
        },
        k = function(e) {
            var i = /\/\/(?:www\.)?vimeo.com\/([0-9a-z\-_]+)/i.exec(e);
            return i && i[1]
        },
        E = function(e) {
            var i = /\/\/(?:www\.)?youtu(?:\.be|be\.com)\/(?:watch\?v=|embed\/)?([a-z0-9_\-]+)/i.exec(e);
            return i && i[1]
        },
        Z = function(e) {
            return '<div class="superlightbox_embed_wrapper"><div class="superlightbox_embed"><iframe width="560" height="315" src="//www.youtube.com/embed/' + I(e) + '" frameborder="0" allowfullscreen></iframe></div></div>'
        },
        I = function(e) {
            var i = e.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&]+)/);
            return null != i ? i[1] : ""
        },
        M = function(e) {
            return "https://img.youtube.com/vi/" + I(e) + "/0.jpg"
        },
        T = function(e) {
            var i = /(?:http?s?:\/\/)?(?:www\.)?(?:vimeo\.com)\/?(\S+)/g;
            if (i.test(e)) e = e.replace(i, '<div class="superlightbox_embed_wrapper"><div class="superlightbox_embed"><iframe width="420" height="345" src="//player.vimeo.com/video/$1" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div></div>');
            return e
        },
        W = function(e) {
            var i = S(e);
            jQuery.ajax({
                type: "GET",
                url: "http://vimeo.com/api/v2/video/" + i + ".json",
                jsonp: "callback",
                dataType: "jsonp",
                success: function(e) {
                    if (jQuery(".superlightbox_video" + e[0].id).length) {
                        var i = e[0].thumbnail_large;
                        jQuery(".superlightbox_video" + e[0].id).css({
                            "background-image": "url('" + i + "')"
                        })
                    }
                }
            })
        },
        S = function(e) {
            var i = e.match(/^.+vimeo.com\/(.*\/)?([^#\?]*)/);
            return i ? i[2] || i[1] : null
        },
        D = function() {
            return '<div class="superlightboxcontainer ' + i + '" style="display:none;"><a href="javascript: void(0);" class="superlightbox_close"></a><div class="superlightbox_wrapper"><div class="superlightbox_slider"></div></div><div class="superlightbox_gallery"><a href="javascript: void(0);" class="superlightbox_gallery_button superlightbox_gallery_open"></a><a href="javascript: void(0);" class="superlightbox_gallery_nav superlightbox_gallery_prev" style="display: none;"></a><a href="javascript: void(0);" class="superlightbox_gallery_nav superlightbox_gallery_next" style="display: none;"></a><div class="superlightbox_gallery_wrapper" style="display: none;"></div></div><a href="javascript: void(0);" class="superlightbox_prev"></a><a href="javascript: void(0);" class="superlightbox_next"></a></div>'
        },
        O = function(e, i) {
            var o = jQuery.extend({}, {
                    pinchImage: "",
                    pinchZoom: function(e) {},
                    pinchZoomStart: function() {},
                    pinchZoomEnd: function() {},
                    swipe: function(e) {},
                    swipeLeft: function(e) {},
                    swipeRight: function(e) {},
                    swipeUp: function(e) {},
                    swipeDown: function(e) {},
                    swipeStart: function(e) {},
                    swipeEnd: function(e, i) {},
                    maxZoom: 3
                }, i),
                u = new Object,
                n = !1,
                a = !1;
            u.sX = 0, u.sY = 0, u.eX = 0, u.eY = 0;
            var s, l, p, h, t, g, d, c, y, b, _, x, v, f, w, j, Q, m, C, X, Y, k, E, Z = 20,
                I = 40,
                M = "",
                T = 1,
                W = 0,
                S = 0,
                D = q,
                O = L,
                r = jQuery(e);
            r.on("touchstart", function(e) {
                if (1 == e.originalEvent.touches.length) {
                    a = !(n = !0);
                    var i = e.originalEvent.touches[0];
                    u.sX = i.screenX, u.sY = i.clientY, 1 == T ? o.swipeStart(u) : o.pinchZoomStart()
                } else if (2 == e.originalEvent.touches.length) {
                    a = !(n = !1);
                    var r = jQuery(window).width() / 2,
                        t = jQuery(window).height() / 2;
                    0 == q && 0 == q && (q = jQuery(o.pinchImage).width(), L = jQuery(o.pinchImage).height(), T = 1, W = r - (D = q), S = t - (O = L)), s = e.originalEvent.touches[0].clientX, l = e.originalEvent.touches[0].clientY, p = e.originalEvent.touches[1].clientX, h = e.originalEvent.touches[1].clientY, k = ((j = (s + p) / 2) - W) / D, E = ((Q = (l + h) / 2) - S) / O, y = Math.sqrt(Math.pow(p - s, 2) + Math.pow(h - l, 2)), o.pinchZoomStart()
                }
            }), r.on("touchmove", function(e) {
                if (e.preventDefault(), n) {
                    var i = e.originalEvent.touches[0];
                    if (u.eX = i.screenX, u.eY = i.clientY, 1 < T)(r = {}).left = W + D + (u.eX - u.sX), r.top = S + O + (u.eY - u.sY), o.pinchZoom(r);
                    else o.swipe(u)
                } else if (a) {
                    var r;
                    t = e.originalEvent.touches[0].clientX, g = e.originalEvent.touches[0].clientY, d = e.originalEvent.touches[1].clientX, c = e.originalEvent.touches[1].clientY, b = Math.sqrt(Math.pow(d - t, 2) + Math.pow(c - g, 2)), X = (D - (v = q * (_ = b / y * T))) * k + (-j + (m = (t + d) / 2)), Y = (O - (x = L * _)) * E + (-Q + (C = (g + c) / 2)), f = parseInt(W + X), w = parseInt(S + Y), (r = {}).left = f + v, r.top = w + x, r.width = v, r.height = x, o.pinchZoom(r)
                }
            }), r.on("touchend", function(e) {
                if (n) {
                    if (1 < T) return W += u.eX - u.sX, void(S += u.eY - u.sY);
                    var i = jQuery(window).width(),
                        r = jQuery(window).height();
                    Z = .1 * i, I = .1 * r, (u.eX - Z > u.sX || u.eX + Z < u.sX) && u.eY < u.sY + 50 && u.sY > u.eY - 50 && (M = u.eX > u.sX ? "l" : "r"), (u.eY - I > u.sY || u.eY + I < u.sY) && u.eX < u.sX + 40 && u.sX > u.eX - 40 && (M = u.eY > u.sY ? "d" : "u"), "" != M && ("l" == M ? o.swipeLeft(u) : "r" == M ? o.swipeRight(u) : "u" == M ? o.swipeUp(u) : "d" == M && o.swipeDown(u)), o.swipeEnd(u, M), M = ""
                } else if (a) {
                    var t = jQuery(window).width() / 2,
                        s = jQuery(window).height() / 2;
                    if (_ < 1) _ = 1, (l = {
                        left: "50%",
                        top: "50%"
                    }).width = q, l.height = L, o.pinchZoom(l), f = t - q, w = s - L, v = q, x = L;
                    else if (_ > o.maxZoom) {
                        var l;
                        _ = o.maxZoom, X = (D - (v = q * _)) * k + (-j + m), Y = (O - (x = L * _)) * E + (-Q + C), f = parseInt(W + X), w = parseInt(S + Y), (l = {}).left = f + v, l.top = w + x, l.width = v, l.height = x, o.pinchZoom(l)
                    }
                    W = f, S = w, D = v, O = x, T = _, o.pinchZoomEnd()
                }
                a = n = !1
            }), r.on("touchcancel", function(e) {
                a = n = !1
            })
        };
    return i = function(e, i) {
        i = i || "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
        for (var r = "", t = 0; t < e; t++) {
            var s = Math.floor(Math.random() * i.length);
            r += i.substring(s, s + 1)
        }
        return r
    }(10), this.each(function() {
        var e = jQuery(this),
            i = e.attr(g.mediaAttribute);
        if (jQuery.inArray(i, u) < 0) {
            u.push(i);
            var r = void 0 !== e.attr(g.mediaCaption) ? e.attr(g.mediaCaption) : "";
            s.push(r)
        }
        e.click(function(e) {
            e.preventDefault(),
                function(e) {
                    var i = e.attr("href");
                    if (-1 < u.indexOf(i)) {
                        n = u.indexOf(i), jQuery(".superlightboxcontainer").length && jQuery(".superlightboxcontainer").remove(), jQuery("body").append(D());
                        var r = '<div class="superlightbox_slide"></div>';
                        jQuery(".superlightbox_slider").append(r), jQuery(".superlightbox_slider").append(r), jQuery(".superlightbox_slider").append(r), g.gallery && 1 < u.length && d(), jQuery(".superlightboxcontainer").fadeIn(), _(), x(n)
                    }
                }(jQuery(this))
        })
    })
}, jQuery(document).ready(function() {
    jQuery(".supergallery").length && jQuery(".supergallery").superLightBox({
        mediaCaption: "data-caption"
    })
});